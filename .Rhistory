require (Rmisc)
require(ggplot2)
require(readxl)
require(dplyr)
library(readxl)
data <- read_excel("data.xlsx")
View(data)
data6=read_excel("data.xlsx",sheet = "lifehistory_trait")
fulldat<-ddply(data6,.(latitude),summarize,growthrate=mean(growthrate),larvaltime=mean(larvaltime))
View(fulldat)
fulldat<-ddply(data6,.(latitude),summarize,growthrate=mean(growthrate),larvaltime=mean(larvaltime),pupaltime=mean(pupaltime),)
fulldat<-ddply(data6,.(latitude),summarize,growthrate=mean(growthrate),larvaltime=mean(larvaltime),totaltime=mean(totaltime),pupalweight=mean(pupalweight),adultweight=mean(adultweight))
View(fulldat)
fulldat<-ddply(data6,.(latitude,longitude),summarize,growthrate=mean(growthrate),larvaltime=mean(larvaltime),totaltime=mean(totaltime),pupalweight=mean(pupalweight),adultweight=mean(adultweight))
View(fulldat)
require (Rmisc)
require(ggplot2)
require(readxl)
require(dplyr)
#chill comma data
data2=read_excel("data.xlsx",sheet = "chill_comma")
#mean of each traits
chill_mean<-ddply(data2,.(latitude,longitude),summarize,ccrt=mean(ccrt))
View(chill_mean)
#mean of each traits
heat_mean<-ddply(data3,.(latitude,longitude),summarize,hkt=mean(knockdown_time))
#heat knock down data
data3=read_excel("data.xlsx",sheet = "heat_knock")
#mean of each traits
heat_mean<-ddply(data3,.(latitude,longitude),summarize,hkt=mean(knockdown_time))
#heat knock down data
data4=read_excel("data.xlsx",sheet = "starvation")
#mean of each traits
starvation_mean<-ddply(data4,.(latitude,longitude),summarize,starvation=mean(time))
#desiccation data
data5=read_excel("data.xlsx",sheet = "desiccation")
#mean of each traits
desi_mean<-ddply(data5,.(latitude,longitude),summarize,desi=mean(time))
View(desi_mean)
#life history trait data set
data1=read_excel("data.xlsx",sheet = "lifehistory_trait")
#mean of each traits
meandat<-ddply(data1,.(latitude,longitude),summarize,growthrate=mean(growthrate),larvaltime=mean(larvaltime),totaltime=mean(totaltime),pupalweight=mean(pupalweight),adultweight=mean(adultweight))
full_mean=cbind(meandat,chill_mean,heat_mean,starvation_mean,desi_mean)
View(full_mean)
#mean of each traits
meandat<-ddply(data1,.(latitude,longitude),summarize,growthrate=mean(growthrate),pupaltime=mean(pupaltime),larvaltime=mean(larvaltime),totaltime=mean(totaltime),pupalweight=mean(pupalweight),adultweight=mean(adultweight))
full_mean=cbind(meandat,chill_mean,heat_mean,starvation_mean,desi_mean)
write.csv(full_mean,"full_mean.csv")
data_correlation=read_excel("data.xlsx",sheet = "correlation_withoutsex")
ggplot(data_correlation,aes(x=hkt,y=growthrate))+geom_point()
ggplot(data_correlation,aes(x=hkt,y=growthrate))+geom_point()+geom_smooth(method="lm")
ggplot(data_correlation,aes(x=hkt,y=growthrate))+geom_point()+geom_smooth(method="lm",se=F)
mod=lm(growthrate~hkt,data_correlation)
summary(mod)
View(data_correlation)
mod=lm(growthrate~desi,data_correlation)
summary(mod)
mod=lm(growthrate~starvation,data_correlation)
summary(mod)
mod=lm(growthrate~ccrt,data_correlation)
summary(mod)
mod=lm(growthrate~larvaltime,data_correlation)
summary(mod)
mod=lm(growthrate~pupalweight,data_correlation)
summary(mod)
mod=lm(pupalweight~larvaltime,data_correlation)
summary(mod)
data_correlation=read_excel("data.xlsx",sheet = "correlation")
ggplot(data_correlation,aes(x=hkt,y=growthrate))+geom_point()+geom_smooth(method="lm",se=F)
require (Rmisc)
require(ggplot2)
require(readxl)
require(dplyr)
data_correlation=read_excel("data.xlsx",sheet = "correlation")
ggplot(data_correlation,aes(x=hkt,y=growthrate))+geom_point()+geom_smooth(method="lm",se=F)
data_correlation=read_excel("data.xlsx",sheet = "correlation_withoutsex")
ggplot(data_correlation,aes(x=hkt,y=growthrate))+geom_point()+geom_smooth(method="lm",se=F)
ggplot(data_correlation,aes(x=desi,y=growthrate))+geom_point()+geom_smooth(method="lm",se=F)
ggplot(data_correlation,aes(x=starvation,y=growthrate))+geom_point()+geom_smooth(method="lm",se=F)
ggplot(data_correlation,aes(x=ccrt,y=growthrate))+geom_point()+geom_smooth(method="lm",se=F)
mod=lm(pupalweight~larvaltime,data_correlation)
ggplot(data_correlation,aes(x=desi,y=starvation))+geom_point()+geom_smooth(method="lm",se=F)
mod=lm(starvation~desi,data_correlation)
summary(mod)
plot(mod)
mod=lm(starvation~log(desi),data_correlation)
summary(mod)
plot(mod)
data1=read_excel("data.xlsx",sheet = "lifehistory_trait")
mod_gr=lm(growthrate~latitude*sex*longitude,data=data1)
summary(mod)
summary(mod_gr)
#desiccation data
data5=read_excel("data.xlsx",sheet = "desiccation")
mod_desi=lm(time~latitude*sex*longitude,data=data5)
summary(mod_desi)
data_correlation=read_excel("data.xlsx",sheet = "correlation")
mod=lm(growthrate~desi*sex,data=data_correlation)
View(data_correlation)
mod=lm(growthrate~desiccatio*sex,data=data_correlation)
mod=lm(growthrate~desiccation*sex,data=data_correlation)
summary(mod)
mod=lm(growthrate~sex,data=data_correlation)
summary(mod)
mod=lm(growthrate~desiccation*sex,data=data_correlation)
summary(mod)
cor.test(data_correlation$growthrate,data_correlation$desiccation)
mod=lm(growthrate~desiccation,data=data_correlation)
summary(mod)
data6=read_excel("data.xlsx",sheet = "correlation")
par(mfrow=c(2,2))
par(mar=c(4, 4, 1, 1))
plot(x=data6$hkt, y=data6$growthrate, col=data6$color,xlim=c(350,585),ylim=c(2.53,2.75),xlab="Heat knock down time (sec)",ylab="Growth rate (ln(mg/day))",mgp=c(2, 0.5, 0))
abline(lm(data6$growthrate~data6$hkt),lwd=1.5)
arrows(data6$hkt,data6$growthrate-data6$se1,data6$hkt,data6$growthrate+data6$se1,angle=90,lwd=1.5,length=0.02,code=3,col=data6$color)
arrows(data6$hkt-data6$se3,data6$growthrate,data6$hkt+data6$se3,data6$growthrate,angle=90,lwd=1.5,length=0.02,code=3,col=data6$color)
legend(350,2.58,c("female","male"),pch=c(1,1),col=data6$color,box.col = "white")
text(540,2.75,"Model       p",col="black",cex=1)
text(540,2.74,"   int.     5.3e-09*",col="black",cex=1)
text(540,2.73,"hkdt   0.03*",col="black",cex=1)
text(540,2.72,"sex    0.32",col="black",cex=1)
par(mar=c(4, 1, 1, 4))
plot(x=data6$ccrt, y=data6$growthrate, xlim=c(900,1900), ylim=c(2.53,2.75),col=data6$color,xlab="Chill comma recovery time (sec)",ylab="",mgp=c(2, 0.5, 0))
abline(lm(data6$growthrate~data6$ccrt),lwd=1.5)
arrows(data6$ccrt,data6$growthrate-data6$se1,data6$ccrt, data6$growthrate+data6$se1,code=3, lwd=1.5,length=0.02, angle = 90,col=data6$color)
arrows(data6$ccrt-data6$se5,data6$growthrate,data6$ccrt+data6$se5,data6$growthrate, code=3, lwd=1.5,length=0.02, angle = 90,col=data6$color)
text(1700,2.75,"Model               p",col="black",cex=1)
text(1700,2.74,"             intercept       6.94e-10*",col="black",cex=1)
text(1700,2.73,"ccrt              0.821",col="black",cex=1)
text(1700,2.72,"sex           0.727",col="black",cex=1)
par(mar=c(4, 4, 1, 1))
plot(x=data6$starvation, y=data6$growthrate,  xlim=c(200,380),ylim=c(2.53,2.75),col=data6$color,xlab="Starvation tolerance (hours)",ylab="Growth rate (ln(mg/day))",mgp=c(2, 0.5, 0))
abline(lm(data6$growthrate~data6$starvation),lwd=1.5)
arrows(data6$starvation-data6$se4,data6$growthrate,data6$starvation+data6$se4,data6$growthrate, code=3, lwd=1.5,length=0.02, angle = 90,col=data6$color)
arrows(data6$starvation,data6$growthrate-data6$se1,data6$starvation,data6$growthrate+data6$se1, code=3, lwd=1.5,length=0.02, angle = 90,col=data6$color)
text(350,2.7,"Model              t            p",col="black",cex=1)
text(350,2.69,"             intercept         2.77    1.16e-10*",col="black",cex=1)
text(350,2.68,"         starvation      -1.305    0.218",col="black",cex=1)
text(350,2.67,"        sex                  0.316    0.76",col="black",cex=1)
par(mar=c(4, 1, 1, 4))
plot(x=data6$desiccation, y=data6$growthrate,  xlim=c(90,170),ylim=c(2.53,2.75),col=data6$color,xlab="Desiccation tolerance (hours)",ylab="",mgp=c(2, 0.5, 0))
abline(lm(data6$growthrate~data6$desiccation),lwd=1.5)
arrows(data6$desiccation-data6$se2,data6$growthrate,data6$desiccation+data6$se2, data6$growthrate,code=3, lwd=1.5,length=0.02, angle = 90,col=data6$color)
arrows(data6$desiccation,data6$growthrate-data6$se1,data6$desiccation,data6$growthrate+data6$se1, code=3, lwd=1.5,length=0.02, angle = 90,col=data6$color)
text(150,2.75,"Model              t            p",col="black",cex=1)
text(150,2.74,"              intercept         28.87    1.01e-11*",col="black",cex=1)
text(150,2.73,"         desiccation    -3.196    0.009*",col="black",cex=1)
text(150,2.72,"       sex                  -0.428    0.68",col="black",cex=1)
